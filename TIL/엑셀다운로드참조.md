```java
/**

사용자페이지 접속 통계 조회

* @param model
 * @return
 * @throws Exception
   */
   @RequestMapping(value="/getListConnectHistory" )	
   public String getListConnectHistory (Model model) throws Exception {

	Map parameter = getParameterMap(); //웹파라미터

	if(!authRoleManager.getCustomUserFromSecurityContext().getAuthorities().toString().contains("ROLE_ADMIN")
			&& !authRoleManager.getCustomUserFromSecurityContext().getAuthorities().toString().contains("ROLE_CHART_ADMIN")){
		String admin_idx = authRoleManager.getCustomUserFromSecurityContext().getUserIdx();
		parameter.put("admin_idx", admin_idx);
	}


		

	Map resultMap = statisticsService.getListConnectHistory(parameter);


			

	// 엑셀 다운로드시
	if ( parameter.get("type") != null && parameter.get("type").equals("excel") ) {	


		    

	    List list = (List) resultMap.get("connectHistoryList");
	    
	    for(int i = 0; i < list.size(); i++) {
	        Map<String, Object> map = (Map) list.get(i);
	        
	        int read_outer_cnt = (int) map.get("read_outer_cnt");
            int read_inner_cnt = (int) map.get("read_inner_cnt");
            int read_total_cnt = read_outer_cnt + read_inner_cnt;

            String route_arr = map.get("route").toString();
            String[] route = route_arr.split(">");
            
            String routeA = "";
            String routeB = "";
            String routeC = "";
            String routeD = "";
            
            if(route.length > 0) routeA = route[0];
            if(route.length > 1) routeB = route[1];
            if(route.length > 2) routeC = route[2];
            if(route.length > 3) routeD = route[3];
            
            map.put("routeA", routeA);
            map.put("routeB", routeB);
            map.put("routeC", routeC);
            map.put("routeD", routeD);
            map.put("read_total_cnt", read_total_cnt);
            
	    }
	    
	    model.addAttribute("list", list);
        return "listCountHistoryExcelView";


            

    // 화면 출력시
    } else {
        model.addAttribute("connectHistoryCount", resultMap.get("connectHistoryCount"));  
        model.addAttribute("connectHistoryList", resultMap.get("connectHistoryList"));
        return "statistics/getListConnectHistory";
    }
}
```

